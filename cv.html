<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CV â€” Hugh Koeze</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500&family=Josefin+Sans:wght@400;600&family=Source+Serif+4:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/styles.css">
  <style>
    /* =========================================
       CV PAGE LAYOUT
       All values from design system
       ========================================= */

    .cv-layout {
      display: flex;
      min-height: calc(100vh - 89px);
    }

    .cv-main {
      flex: 1;
      padding: var(--space-5) var(--space-4);
      padding-right: var(--space-4);
      overflow-y: auto;
      transition: padding-right 0.3s ease;
    }

    .cv-main.preview-open {
      padding-right: calc(40% + var(--space-4));
    }

    /* =========================================
       PREVIEW PANEL
       ========================================= */

    .cv-preview {
      position: fixed;
      top: 89px;
      right: 0;
      width: 40%;
      height: calc(100vh - 89px);
      background: var(--warm-white);
      border-left: 1px solid var(--mortar);
      display: flex;
      flex-direction: column;
      transform: translateX(100%);
      transition: transform 0.3s ease;
    }

    .cv-preview.open {
      transform: translateX(0);
    }

    /* Preview: Empty State */
    .cv-preview-empty {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100%;
      padding: var(--space-4);
      text-align: center;
    }

    .cv-preview-empty-title {
      font-family: var(--font-display);
      font-size: 0.9rem;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      color: var(--stone-gray);
      margin-bottom: var(--space-2);
    }

    .cv-preview-empty-hint {
      font-family: var(--font-body);
      font-size: 0.9rem;
      color: var(--mortar);
      max-width: 200px;
    }

    /* Preview: Content */
    .cv-preview-content {
      display: none;
      flex-direction: column;
      height: 100%;
    }

    .cv-preview-content.active {
      display: flex;
    }

    /* Preview: Header */
    .cv-preview-header {
      padding: var(--space-3) var(--space-4);
      border-bottom: 1px solid var(--mortar);
      background: var(--cream);
      border-left: 3px solid var(--verdigris);
    }

    .cv-preview-type {
      font-family: var(--font-mono);
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: var(--brick);
      margin-bottom: var(--space-1);
    }

    .cv-preview-title {
      font-family: var(--font-display);
      font-size: 1.1rem;
      font-weight: 600;
      letter-spacing: 0.02em;
      color: var(--charcoal);
      margin-bottom: var(--space-1);
    }

    .cv-preview-context {
      font-family: var(--font-body);
      font-size: 0.9rem;
      color: var(--charcoal-light);
      line-height: 1.5;
    }

    /* Preview: Body */
    .cv-preview-body {
      flex: 1;
      overflow: auto;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: var(--space-3);
      background: var(--warm-white);
    }

    .cv-preview-body iframe {
      width: 100%;
      height: 100%;
      border: 1px solid var(--mortar);
    }

    .cv-preview-body img {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
      border: 1px solid var(--mortar);
    }

    .cv-preview-body .video-container {
      width: 100%;
      aspect-ratio: 16/9;
    }

    .cv-preview-body .video-container iframe {
      width: 100%;
      height: 100%;
      border: none;
    }

    /* Preview: Footer */
    .cv-preview-footer {
      padding: var(--space-3) var(--space-4);
      border-top: 1px solid var(--mortar);
      background: var(--cream);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .cv-preview-hints {
      font-family: var(--font-mono);
      font-size: 0.7rem;
      color: var(--stone-gray);
    }

    .cv-preview-hints kbd {
      background: var(--warm-white);
      border: 1px solid var(--mortar);
      padding: 2px 6px;
      margin: 0 2px;
      font-family: var(--font-mono);
      font-size: 0.65rem;
    }

    /* Open full link */
    .cv-preview-open {
      font-family: var(--font-display);
      font-size: 0.9rem;
      letter-spacing: 0.05em;
      color: var(--verdigris);
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .cv-preview-open::after {
      content: 'â†—';
      transition: transform 0.2s ease;
    }

    .cv-preview-open:hover {
      color: var(--verdigris-dark);
    }

    .cv-preview-open:hover::after {
      transform: translate(2px, -2px);
    }

    /* =========================================
       PREVIEW TOGGLE BUTTON
       ========================================= */

    .cv-preview-toggle {
      position: fixed;
      top: 50%;
      right: 0;
      transform: translateY(-50%);
      background: var(--warm-white);
      border: 1px solid var(--mortar);
      border-right: none;
      padding: var(--space-2) var(--space-1);
      cursor: pointer;
      transition: all 0.3s ease;
      z-index: 10;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
    }

    .cv-preview-toggle:hover {
      background: var(--cream);
      border-color: var(--verdigris);
    }

    .cv-preview-toggle .toggle-label {
      font-family: var(--font-display);
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: var(--charcoal-light);
      writing-mode: vertical-rl;
      text-orientation: mixed;
    }

    .cv-preview-toggle.panel-open {
      right: 40%;
    }

    /* =========================================
       CV CONTENT
       ========================================= */

    .cv-header {
      margin-bottom: var(--space-5);
      max-width: 600px;
    }

    .cv-header h1 {
      font-size: 2rem;
      margin-bottom: var(--space-2);
    }

    .cv-header .intro {
      font-family: var(--font-body);
      color: var(--charcoal-light);
      margin-bottom: var(--space-3);
    }

    .cv-header .instruction {
      font-family: var(--font-mono);
      font-size: 0.8rem;
      color: var(--stone-gray);
      display: inline-flex;
      align-items: center;
      gap: var(--space-1);
    }

    .cv-header .instruction::before {
      content: 'â—†';
      font-size: 0.5rem;
      color: var(--verdigris);
    }

    /* CV Sections */
    .cv-section {
      margin-bottom: var(--space-5);
      max-width: 600px;
    }

    .cv-section h2 {
      font-size: 1rem;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: var(--oak);
      padding-bottom: var(--space-2);
      border-bottom: 1px solid var(--mortar);
      margin-bottom: var(--space-3);
      position: relative;
    }

    .cv-section h2::after {
      content: '';
      position: absolute;
      bottom: -1px;
      left: 0;
      width: 48px;
      height: 1px;
      background: var(--verdigris);
    }

    /* CV Items */
    .cv-item {
      margin-bottom: var(--space-4);
      padding-left: var(--space-3);
      border-left: 2px solid transparent;
      transition: border-color 0.2s ease;
    }

    .cv-item:hover {
      border-left-color: var(--sage);
    }

    .cv-item.active {
      border-left-color: var(--verdigris);
    }

    .cv-item-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      margin-bottom: 4px;
      gap: var(--space-2);
    }

    .cv-item-title {
      font-family: var(--font-display);
      font-weight: 600;
      letter-spacing: 0.02em;
      color: var(--charcoal);
    }

    .cv-item-date {
      font-family: var(--font-mono);
      font-size: 0.75rem;
      color: var(--stone-gray);
      white-space: nowrap;
    }

    .cv-item-org {
      font-family: var(--font-body);
      font-style: italic;
      color: var(--charcoal-light);
      font-size: 0.95rem;
      margin-bottom: 4px;
    }

    .cv-item-desc {
      font-family: var(--font-body);
      font-size: 0.95rem;
      color: var(--charcoal-light);
      margin-bottom: var(--space-2);
    }

    /* Sub-items (courses, etc.) */
    .cv-sub-items {
      margin-top: var(--space-2);
      margin-left: var(--space-2);
      padding-left: var(--space-2);
      border-left: 1px solid var(--mortar);
    }

    .cv-sub-item {
      margin-bottom: var(--space-2);
    }

    .cv-sub-item-title {
      font-family: var(--font-display);
      font-size: 0.9rem;
      font-weight: 600;
      color: var(--charcoal);
    }

    .cv-sub-item-meta {
      font-family: var(--font-mono);
      font-size: 0.7rem;
      color: var(--stone-gray);
      margin-left: var(--space-1);
    }

    .cv-sub-item-desc {
      font-family: var(--font-body);
      font-size: 0.85rem;
      color: var(--charcoal-light);
      margin-top: 2px;
    }

    /* CV Item Links */
    .cv-item-links {
      display: flex;
      flex-wrap: wrap;
      gap: var(--space-2);
      margin-top: var(--space-2);
    }

    .cv-item-link {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-family: var(--font-display);
      font-size: 0.8rem;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      text-decoration: none;
      padding: var(--space-1) var(--space-2);
      background: transparent;
      border: 1px solid var(--mortar);
      color: var(--charcoal-light);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .cv-item-link:hover {
      border-color: var(--verdigris);
      color: var(--verdigris);
    }

    .cv-item-link.active {
      background: var(--verdigris);
      border-color: var(--verdigris);
      color: var(--warm-white);
    }

    .cv-item-link .icon {
      font-size: 0.85rem;
    }

    /* Placeholder badge for missing content */
    .cv-item-link.placeholder {
      border-style: dashed;
      opacity: 0.6;
    }

    .cv-item-link.placeholder:hover {
      opacity: 1;
    }

    /* Placeholder for demo */
    .placeholder-content {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background: var(--cream);
      border: 1px dashed var(--mortar);
      padding: var(--space-4);
      text-align: center;
      width: 100%;
      min-height: 300px;
    }

    .placeholder-content .icon {
      font-size: 3rem;
      margin-bottom: var(--space-2);
      color: var(--stone-gray);
    }

    .placeholder-content span {
      font-family: var(--font-mono);
      font-size: 0.8rem;
      color: var(--stone-gray);
    }

    .placeholder-content .placeholder-note {
      font-family: var(--font-body);
      font-size: 0.85rem;
      color: var(--brick);
      margin-top: var(--space-2);
      font-style: italic;
    }

    /* =========================================
       RESPONSIVE
       ========================================= */

    @media (max-width: 1024px) {
      .cv-preview {
        width: 50%;
      }

      .cv-main.preview-open {
        padding-right: calc(50% + var(--space-4));
      }

      .cv-preview-toggle.panel-open {
        right: 50%;
      }
    }

    @media (max-width: 768px) {
      .cv-preview {
        width: 100%;
        top: 0;
        height: 100vh;
        z-index: 100;
      }

      .cv-main.preview-open {
        padding-right: var(--space-4);
      }

      .cv-preview-toggle {
        display: none;
      }

      .cv-preview-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
      }

      .cv-preview-close-mobile {
        display: block;
        background: none;
        border: none;
        font-size: 1.5rem;
        color: var(--stone-gray);
        cursor: pointer;
        padding: 0;
        line-height: 1;
      }
    }

    @media (min-width: 769px) {
      .cv-preview-close-mobile {
        display: none;
      }
    }
  </style>
</head>
<body>

  <header>
    <div class="container">
      <nav>
        <a href="index.html" class="site-title">Hugh Koeze</a>
        <ul>
          <li><a href="cv.html">CV</a></li>
          <li><a href="projects.html">Projects</a></li>
          <li><a href="photography.html">Photography</a></li>
          <li><a href="about.html">About</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <!-- Toggle button for preview panel -->
  <button class="cv-preview-toggle" id="preview-toggle" title="Toggle preview panel">
    <span class="toggle-label" id="toggle-label">Open Preview</span>
  </button>

  <div class="cv-layout">
    <main class="cv-main" id="cv-main">
      <div class="cv-header">
        <h1>Curriculum Vitae</h1>
        <p class="intro">Reader, writer, and teacher. My work explores how literature shapes and is shaped by place, technology, and community.</p>
        <p class="instruction">Click highlighted items to preview examples</p>
      </div>

      <!-- Content will be loaded dynamically from JSON -->
      <div id="cv-content"></div>

    </main>

    <aside class="cv-preview" id="cv-preview">
      <div class="cv-preview-empty" id="preview-empty">
        <div class="cv-preview-empty-title">Preview Panel</div>
        <p class="cv-preview-empty-hint">Click any preview button to see examples of my work</p>
      </div>
      <div class="cv-preview-content" id="preview-content">
        <div class="cv-preview-header">
          <div>
            <div class="cv-preview-type" id="preview-type">PDF</div>
            <div class="cv-preview-title" id="preview-title">Title</div>
            <p class="cv-preview-context" id="preview-context">Context goes here</p>
          </div>
          <button class="cv-preview-close-mobile" id="preview-close-mobile" aria-label="Close preview">Ã—</button>
        </div>
        <div class="cv-preview-body" id="preview-body">
          <!-- Dynamic content loads here -->
        </div>
        <div class="cv-preview-footer">
          <span class="cv-preview-hints"><kbd>Esc</kbd> to close</span>
          <a href="#" class="cv-preview-open" id="open-link">Open full</a>
        </div>
      </div>
    </aside>
  </div>

  <script>
    // Elements
    const cvMain = document.getElementById('cv-main');
    const cvPreview = document.getElementById('cv-preview');
    const previewToggle = document.getElementById('preview-toggle');
    const toggleLabel = document.getElementById('toggle-label');
    const previewContent = document.getElementById('preview-content');
    const previewEmpty = document.getElementById('preview-empty');
    const previewType = document.getElementById('preview-type');
    const previewTitle = document.getElementById('preview-title');
    const previewContext = document.getElementById('preview-context');
    const previewBody = document.getElementById('preview-body');
    const openLink = document.getElementById('open-link');
    const closeMobile = document.getElementById('preview-close-mobile');
    const cvContent = document.getElementById('cv-content');

    let panelOpen = false;
    let cvData = null;

    // Load CV data from JSON
    async function loadCV() {
      try {
        const response = await fetch('data/cv.json');
        cvData = await response.json();
        renderCV();
      } catch (error) {
        console.error('Failed to load CV data:', error);
        cvContent.innerHTML = '<p>Failed to load CV content.</p>';
      }
    }

    // Render CV content from data
    function renderCV() {
      let html = '';

      // Current Position
      html += renderCurrentPosition();

      // Leadership
      html += renderSection('Leadership', cvData.leadership, renderLeadershipItem);

      // Coaching
      html += renderSection('Coaching & Athletics', cvData.coaching, renderCoachingItem);

      // Education
      html += renderSection('Education', cvData.education, renderEducationItem);

      // Previous Teaching
      html += renderSection('Previous Experience', cvData.teaching.previous, renderPreviousTeachingItem);

      cvContent.innerHTML = html;
      attachLinkListeners();
    }

    // Render current position with courses
    function renderCurrentPosition() {
      const pos = cvData.teaching.current;
      let html = `
        <section class="cv-section">
          <h2>Current Position</h2>
          <div class="cv-item" data-item="${pos.id}">
            <div class="cv-item-header">
              <span class="cv-item-title">${pos.title}</span>
              <span class="cv-item-date">${pos.dates}</span>
            </div>
            <div class="cv-item-org">${pos.institution}, ${pos.location}</div>
            <p class="cv-item-desc">${pos.description}</p>

            <div class="cv-sub-items">
              <h3 style="font-family: var(--font-display); font-size: 0.85rem; text-transform: uppercase; letter-spacing: 0.1em; color: var(--oak); margin-bottom: var(--space-2);">Courses Taught</h3>
      `;

      pos.courses.forEach(course => {
        html += `
              <div class="cv-sub-item">
                <span class="cv-sub-item-title">${course.name}</span>
                ${course.grades ? `<span class="cv-sub-item-meta">${course.grades}</span>` : ''}
                <p class="cv-sub-item-desc">${course.description}</p>
                <div class="cv-item-links">
                  <a class="cv-item-link placeholder"
                     data-preview="pdf"
                     data-src=""
                     data-title="${course.name} Scope & Sequence"
                     data-context="Course scope and sequence document."
                     data-type="Spreadsheet"
                     data-placeholder="true">
                    <span class="icon">ðŸ“Š</span> Scope & Sequence
                  </a>
                </div>
              </div>
        `;
      });

      html += `
            </div>
          </div>
        </section>
      `;
      return html;
    }

    // Render a section
    function renderSection(title, items, renderFn) {
      if (!items || items.length === 0) return '';

      let html = `
        <section class="cv-section">
          <h2>${title}</h2>
      `;

      items.forEach(item => {
        html += renderFn(item);
      });

      html += '</section>';
      return html;
    }

    // Render leadership item
    function renderLeadershipItem(item) {
      let html = `
        <div class="cv-item" data-item="${item.id}">
          <div class="cv-item-header">
            <span class="cv-item-title">${item.title}</span>
            <span class="cv-item-date">${item.dates}</span>
          </div>
          <div class="cv-item-org">${item.institution}</div>
          <p class="cv-item-desc">${item.description}</p>
      `;

      if (item.previews && item.previews.length > 0) {
        html += '<div class="cv-item-links">';
        item.previews.forEach(preview => {
          const icon = getIconForType(preview.type);
          const hasFile = preview.file !== null;
          html += `
            <a class="cv-item-link ${hasFile ? '' : 'placeholder'}"
               data-preview="${preview.type.toLowerCase()}"
               data-src="${preview.file || ''}"
               data-title="${preview.title}"
               data-context="${item.title}"
               data-type="${preview.type}"
               data-placeholder="${!hasFile}">
              <span class="icon">${icon}</span> ${preview.title}
            </a>
          `;
        });
        html += '</div>';
      }

      html += '</div>';
      return html;
    }

    // Render coaching item
    function renderCoachingItem(item) {
      let html = `
        <div class="cv-item" data-item="${item.id}">
          <div class="cv-item-header">
            <span class="cv-item-title">${item.sport}</span>
            <span class="cv-item-date">${item.dates}</span>
          </div>
          <div class="cv-item-org">${item.role}, ${item.institution}</div>
          <div class="cv-item-links">
            <a class="cv-item-link placeholder"
               data-preview="image"
               data-src=""
               data-title="${item.sport} Photos"
               data-context="Photos from coaching ${item.sport}."
               data-type="Photo"
               data-placeholder="true">
              <span class="icon">ðŸ“·</span> Photos
            </a>
          </div>
        </div>
      `;
      return html;
    }

    // Render education item
    function renderEducationItem(item) {
      let html = `
        <div class="cv-item" data-item="${item.id}">
          <div class="cv-item-header">
            <span class="cv-item-title">${item.degree}</span>
            <span class="cv-item-date">${item.dates}</span>
          </div>
          <div class="cv-item-org">${item.institution}, ${item.location}</div>
      `;

      if (item.honors) {
        html += `<p class="cv-item-desc">${item.honors}</p>`;
      }

      if (item.description) {
        html += `<p class="cv-item-desc">${item.description}</p>`;
      }

      // Thesis
      if (item.thesis) {
        html += `
          <div class="cv-item-links">
            <a class="cv-item-link placeholder"
               data-preview="pdf"
               data-src=""
               data-title="${item.thesis.title}"
               data-context="Honors thesis."
               data-type="PDF"
               data-placeholder="true">
              <span class="icon">ðŸ“„</span> Thesis
            </a>
          </div>
        `;
      }

      // Capstones
      if (item.capstones && item.capstones.length > 0) {
        html += '<div class="cv-item-links">';
        item.capstones.forEach(cap => {
          const icon = cap.type === 'Paper' ? 'ðŸ“„' : 'ðŸ“·';
          html += `
            <a class="cv-item-link placeholder"
               data-preview="${cap.type === 'Paper' ? 'pdf' : 'image'}"
               data-src=""
               data-title="${cap.title}"
               data-context="Bread Loaf capstone project."
               data-type="${cap.type}"
               data-placeholder="true">
              <span class="icon">${icon}</span> ${cap.type === 'Paper' ? 'Paper' : 'Project'}
            </a>
          `;
        });
        html += '</div>';
      }

      html += '</div>';
      return html;
    }

    // Render previous teaching item
    function renderPreviousTeachingItem(item) {
      return `
        <div class="cv-item" data-item="${item.id}">
          <div class="cv-item-header">
            <span class="cv-item-title">${item.title}</span>
            <span class="cv-item-date">${item.dates}</span>
          </div>
          <div class="cv-item-org">${item.institution}, ${item.location}</div>
          ${item.description ? `<p class="cv-item-desc">${item.description}</p>` : ''}
        </div>
      `;
    }

    // Get icon for content type
    function getIconForType(type) {
      const icons = {
        'PDF': 'ðŸ“„',
        'Video': 'ðŸŽ¬',
        'Photo': 'ðŸ“·',
        'Presentation': 'ðŸ“Š',
        'Spreadsheet': 'ðŸ“Š',
        'Slides': 'ðŸ“Š'
      };
      return icons[type] || 'ðŸ“„';
    }

    // Toggle panel visibility
    function togglePanel(open) {
      panelOpen = open;
      if (open) {
        cvPreview.classList.add('open');
        cvMain.classList.add('preview-open');
        previewToggle.classList.add('panel-open');
        toggleLabel.textContent = 'Close Preview';
      } else {
        cvPreview.classList.remove('open');
        cvMain.classList.remove('preview-open');
        previewToggle.classList.remove('panel-open');
        toggleLabel.textContent = 'Open Preview';
      }
    }

    // Show preview content
    function showPreview(link) {
      const type = link.dataset.preview;
      const src = link.dataset.src;
      const title = link.dataset.title;
      const context = link.dataset.context;
      const typeLabel = link.dataset.type;
      const isPlaceholder = link.dataset.placeholder === 'true';

      // Update active states
      document.querySelectorAll('.cv-item-link').forEach(l => l.classList.remove('active'));
      document.querySelectorAll('.cv-item').forEach(i => i.classList.remove('active'));
      link.classList.add('active');
      link.closest('.cv-item').classList.add('active');

      // Update header
      previewType.textContent = typeLabel;
      previewTitle.textContent = title;
      previewContext.textContent = context;

      // Clear and populate body
      previewBody.innerHTML = '';

      if (isPlaceholder || !src) {
        // Show placeholder for missing content
        const icon = getIconForType(typeLabel);
        previewBody.innerHTML = `
          <div class="placeholder-content">
            <div class="icon">${icon}</div>
            <span>${typeLabel}<br>${title}</span>
            <p class="placeholder-note">Content to be added</p>
          </div>
        `;
        openLink.style.display = 'none';
      } else if (type === 'pdf') {
        previewBody.innerHTML = `<iframe src="${src}"></iframe>`;
        openLink.href = src;
        openLink.style.display = 'inline-flex';
      } else if (type === 'image' || type === 'photo' || type === 'slides') {
        const img = document.createElement('img');
        img.src = src;
        img.alt = title;
        previewBody.appendChild(img);
        openLink.href = src;
        openLink.style.display = 'inline-flex';
      } else if (type === 'video') {
        previewBody.innerHTML = `
          <div class="video-container">
            <iframe src="${src}" frameborder="0" allowfullscreen></iframe>
          </div>
        `;
        openLink.href = src;
        openLink.style.display = 'inline-flex';
      } else {
        const icon = getIconForType(typeLabel);
        previewBody.innerHTML = `
          <div class="placeholder-content">
            <div class="icon">${icon}</div>
            <span>${typeLabel}<br>${title}</span>
          </div>
        `;
        openLink.style.display = 'none';
      }

      // Show preview panel and content
      previewEmpty.style.display = 'none';
      previewContent.classList.add('active');
      togglePanel(true);
    }

    // Close preview
    function closePreview() {
      previewContent.classList.remove('active');
      previewEmpty.style.display = 'flex';
      document.querySelectorAll('.cv-item-link').forEach(l => l.classList.remove('active'));
      document.querySelectorAll('.cv-item').forEach(i => i.classList.remove('active'));
    }

    // Attach event listeners to dynamically created links
    function attachLinkListeners() {
      document.querySelectorAll('.cv-item-link').forEach(link => {
        link.addEventListener('click', (e) => {
          e.preventDefault();
          showPreview(link);
        });
      });
    }

    // Event: Toggle button
    previewToggle.addEventListener('click', () => {
      if (panelOpen) {
        togglePanel(false);
        closePreview();
      } else {
        togglePanel(true);
      }
    });

    // Event: Mobile close button
    closeMobile.addEventListener('click', () => {
      togglePanel(false);
      closePreview();
    });

    // Event: Keyboard (Escape to close)
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && panelOpen) {
        togglePanel(false);
        closePreview();
      }
    });

    // Initialize
    togglePanel(false);
    loadCV();
  </script>

</body>
</html>
